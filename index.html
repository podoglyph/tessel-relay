<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tessel Relay with ReactJS</title>
</head>
<body>
  <h1>Tessel Relay</h1>
  <p>Press a button to toggle an LED.</p>
  <ul>
    <li>
      <button class="led-button" data-led="0">Red</button>
      Status: <span class="led-status"></span>
    </li>
    <li>
      <button class="led-button" data-led="1">Orange</button>
      Status: <span class="led-status"></span>
    </li>
    <li>
      <button class="led-button" data-led="2">Green</button>
      Status: <span class="led-status"></span>
    </li>
    <li>
      <button class="led-button" data-led="3">Blue</button>
      Status: <span class="led-status"></span>
    </li>
  </ul>
  <script type="text/javascript">
    var buttons = document.querySelectorAll('.led-button');

    Array.prototype.forEach.call(buttons, function (button) {
      button.addEventListener('click', toggleLed);
    });

    function toggleLed (event) {
      var button = event.target;
      var ledIndex = button.getAttribute('data-led');
      var statusNode = button.parentNode.querySelector('.led-status');

      var req = new XMLHttpRequest();

      req.open('GET', '/leds/' + ledIndex);

      req.onload = function(e) {
        if (req.readyState == 4 && req.status == 200) {
          var response = JSON.parse(req.responseText);
          statusNode.textContent = response.on ? 'ON' : 'OFF';
        } else {
          console.log('Error', e);
        }
      }
      req.send();
    }
  </script>
</body>
</html>
